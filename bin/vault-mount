#!/bin/sh

set -eu

cd "$VAULTSDIR"

NAME=$1

if vault-loc "$NAME" 2>/dev/null; then
  echo "already mounted" >&2
  exit 1
fi

BUNDLE="${NAME}.sparsebundle"

if [ ! -e "$BUNDLE" ]; then
  echo "${PWD}/${BUNDLE} doesn't exist" >&2
  exit 1
fi

hdiutil attach "$BUNDLE" > "${NAME}.$(hostname -s).mount"
